<!doctype html>
<html
  lang="{{ with site.Params.isoCode | default (site.LanguageCode | default `en`) }}{{- . -}}{{ end }}"
  dir="{{ cond (site.Params.rtl | default false) `rtl` `ltr` }}"
  class="scroll-smooth"
  data-default-appearance="{{ site.Params.defaultAppearance | default `light` }}"
  data-auto-appearance="{{ site.Params.autoSwitchAppearance | default `true` }}">
  {{- partial "head.html" . -}}
  {{- partialCached "init.html" . -}}

  {{ $bodyLayout := "flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32" }}
  {{ $bodyColor := "text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral" }}
  <body class="{{ $bodyLayout }} {{ $bodyColor }} {{ if site.Params.enableStyledScrollbar | default true }}bf-scrollbar{{ end }}">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        {{ i18n "nav.skip_to_main" }}
      </a>
    </div>
    <!-- 全局动态背景 -->
    {{ $disableImageOptimization := .Site.Params.disableImageOptimization | default false }}
    <div class="fixed inset-x-0 top-0 -z-10">
      {{ $useDefault := true }}
      {{ $homepageImage := "" }}
      {{ with .Site.Params.defaultBackgroundImage }}
        {{ if or (strings.HasPrefix . "http:") (strings.HasPrefix . "https:") }}
          {{ $homepageImage = resources.GetRemote . }}
        {{ else }}
          {{ $homepageImage = resources.Get . }}
        {{ end }}
      {{ end }}
      {{ with .Site.Params.homepage.homepageImage }}
        {{ if or (strings.HasPrefix . "http:") (strings.HasPrefix . "https:") }}
          {{ $homepageImage = resources.GetRemote . }}
          {{ $useDefault = false }}
        {{ else }}
          {{ $homepageImage = resources.Get . }}
          {{ $useDefault = false }}
        {{ end }}
      {{ end }}
      {{ if $homepageImage }}
        {{ $style := "" }}
        {{ $defaultPosition := cond $useDefault site.Params.imagePosition false }}
        {{ with $.Params.imagePosition | default $defaultPosition }}
          {{ $style = printf "object-position: %s;" . }}
        {{ end }}
        <img
          id="background-image"
          class="nozoom mt-0 mr-0 mb-0 ml-0 h-[1000px] w-full object-cover"
          src="{{ $homepageImage.RelPermalink }}"
          role="presentation"
          {{ if $style }}style="{{ $style | safeCSS }}"{{ end }}>
        <div
          class="from-neutral absolute inset-0 h-[1000px] bg-gradient-to-t to-transparent mix-blend-normal dark:from-neutral-800"></div>
        <div
          class="from-neutral absolute inset-0 h-[1000px] bg-gradient-to-t to-neutral-100 opacity-60 mix-blend-normal dark:from-neutral-800 dark:to-neutral-800"></div>
      {{ end }}
    </div>
    {{ if .Site.Params.homepage.layoutBackgroundBlur | default false }}
      <div
        id="background-blur"
        class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-xl bg-neutral-100/75 dark:bg-neutral-800/60"></div>
      {{ $backgroundBlur := resources.Get "js/background-blur.js" }}
      {{ $backgroundBlur = $backgroundBlur | resources.Minify | resources.Fingerprint (.Site.Params.fingerprintAlgorithm | default "sha512") }}
      <script
        type="text/javascript"
        src="{{ $backgroundBlur.RelPermalink }}"
        integrity="{{ $backgroundBlur.Data.Integrity }}"
        data-blur-id="background-blur"
        data-image-id="background-image"
        {{ if $homepageImage }}data-image-url="{{ $homepageImage.RelPermalink }}"{{ end }}></script>
    {{ end }}
    {{ $header := print "header/" site.Params.header.layout ".html" }}
    {{ if templates.Exists ( printf "partials/%s" $header ) }}
      {{ partial $header . }}
    {{ else }}
      {{ partial "header/basic.html" . }}
    {{ end }}
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        {{ block "main" . }}{{ end }}
        {{ if and (site.Params.footer.showScrollToTop | default true) }}
          {{- partial "scroll-to-top.html" . -}}
        {{ end }}
      </main>
      {{- partial "footer.html" . -}}
      {{ if site.Params.enableSearch | default false }}
        {{- partial "search.html" . -}}
      {{ end }}
    </div>
  </body>
  {{ if site.Params.buymeacoffee.globalWidget | default false }}
    <script
      data-name="BMC-Widget"
      data-cfasync="false"
      src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js"
      data-id="{{ site.Params.buymeacoffee.identifier }}"
      data-description="Support me on Buy me a coffee!"
      {{ with site.Params.buymeacoffee.globalWidgetMessage }}data-message="{{ . }}"{{ end }}
      {{ with site.Params.buymeacoffee.globalWidgetColor | default `#FFDD00` }}data-color="{{ . }}"{{ end }}
      {{ with site.Params.buymeacoffee.globalWidgetPosition }}data-position="{{ . }}"{{ end }}
      data-x_margin="18"
      data-y_margin="18"></script>
  {{ end }}
</html>